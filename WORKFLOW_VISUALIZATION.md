# LangGraph Workflow with Toast Notifications

## Visual Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User clicks "ğŸš€ TÃ¬m kiáº¿m ThÃ´ng minh (LangGraph AI)"       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ§  AI Ä‘ang phÃ¢n tÃ­ch vÃ  tÃ¬m kiáº¿m... (Spinner)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘   LANGGRAPH WORKFLOW EXECUTION       â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 1: analyze_query                                      â”‚
â”‚  Toast: ğŸ” PhÃ¢n tÃ­ch Query: medical (en)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 2: plan_strategy                                      â”‚
â”‚  Toast: ğŸ“‹ Láº­p Chiáº¿n lÆ°á»£c: 2 nguá»“n                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 3: optimize_queries                                   â”‚
â”‚  Toast: âš™ï¸ Tá»‘i Æ°u Query                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 4: execute_search                                     â”‚
â”‚  Toast: ğŸš€ TÃ¬m kiáº¿m Dá»¯ liá»‡u: TÃ¬m Ä‘Æ°á»£c 47 bÃ i bÃ¡o          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 5: evaluate_results (AI Filtering)                    â”‚
â”‚  Toast: ğŸ“Š ÄÃ¡nh giÃ¡ & Lá»c: 23 bÃ i cháº¥t lÆ°á»£ng cao (â­7.8/10)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
                    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•—
                    â•‘  DECISION  â•‘
                    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•
                     â†™          â†˜
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ Need Refine?â”‚   â”‚ Quality OK?  â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“                  â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ STEP 6a: refine  â”‚   â”‚ STEP 6b:        â”‚
    â”‚ Toast: ğŸ”„ Tinh   â”‚   â”‚ synthesize      â”‚
    â”‚ chá»‰nh Query:     â”‚   â”‚ Toast: ğŸ“ Tá»•ng  â”‚
    â”‚ Láº§n 1/2          â”‚   â”‚ há»£p: 23 bÃ i bÃ¡o â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“                         â†“
    (Loop back to                    â†“
     optimize_queries)                â†“
                                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  COMPLETION                                                  â”‚
â”‚  Toast: âœ… HoÃ n thÃ nh tÃ¬m kiáº¿m!                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Display Results in UI                                       â”‚
â”‚  - ğŸ“š BÃ i bÃ¡o: 23                                           â”‚
â”‚  - â­ Cháº¥t lÆ°á»£ng: 7.8 (Tá»‘t)                                â”‚
â”‚  - ğŸ”„ Refinement: 0/2                                       â”‚
â”‚  - ğŸ—‘ï¸ ÄÃ£ loáº¡i: 24                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Toast Notification Details

### Phase 1: Analysis & Planning
| Step | Toast Icon | Message Format | Example |
|------|------------|----------------|---------|
| analyze_query | ğŸ” | `{name}: {topic} ({language})` | "PhÃ¢n tÃ­ch Query: medical (en)" |
| plan_strategy | ğŸ“‹ | `{name}: {sources_count} nguá»“n` | "Láº­p Chiáº¿n lÆ°á»£c: 2 nguá»“n" |
| optimize_queries | âš™ï¸ | `{name}` | "Tá»‘i Æ°u Query" |

### Phase 2: Search & Evaluation
| Step | Toast Icon | Message Format | Example |
|------|------------|----------------|---------|
| execute_search | ğŸš€ | `{name}: TÃ¬m Ä‘Æ°á»£c {total} bÃ i bÃ¡o` | "TÃ¬m kiáº¿m Dá»¯ liá»‡u: TÃ¬m Ä‘Æ°á»£c 47 bÃ i bÃ¡o" |
| evaluate_results | ğŸ“Š | `{name}: {kept} bÃ i cháº¥t lÆ°á»£ng cao (â­{score}/10)` | "ÄÃ¡nh giÃ¡ & Lá»c: 23 bÃ i (â­7.8/10)" |

### Phase 3: Refinement (Optional)
| Step | Toast Icon | Message Format | Example |
|------|------------|----------------|---------|
| refine_query | ğŸ”„ | `{name}: Láº§n {count}/2` | "Tinh chá»‰nh Query: Láº§n 1/2" |

### Phase 4: Synthesis & Completion
| Step | Toast Icon | Message Format | Example |
|------|------------|----------------|---------|
| synthesize_findings | ğŸ“ | `{name}: {papers_count} bÃ i bÃ¡o` | "Tá»•ng há»£p Káº¿t quáº£: 23 bÃ i bÃ¡o" |
| completion | âœ… | `HoÃ n thÃ nh tÃ¬m kiáº¿m!` | "HoÃ n thÃ nh tÃ¬m kiáº¿m!" |

## State Data Extracted for Toasts

Each toast extracts specific data from the node state:

```python
# analyze_query
{
    'query_analysis': {
        'topic': 'medical',
        'language': 'en',
        'intent': 'review',
        'keywords': [...]
    }
}

# plan_strategy
{
    'search_strategy': {
        'sources': ['PubMed', 'Semantic Scholar'],
        ...
    }
}

# execute_search
{
    'search_results': {
        'PubMed': [...],  # 25 articles
        'Semantic Scholar': [...]  # 22 articles
    }
}

# evaluate_results
{
    'filtered_results': [...],  # 23 quality articles
    'filter_statistics': {
        'avg_score': 7.8,
        'total_found': 47,
        'discarded': 24
    }
}

# refine_query
{
    'refinement_count': 1
}

# synthesize_findings
{
    'synthesis_metadata': {
        'papers_count': 23,
        'status': 'completed'
    }
}
```

## Error Handling

If an error occurs during execution:

```
âŒ Toast: "Lá»—i: Connection timeout..."
+ Error message in main UI with traceback
```

## Performance Considerations

- Toasts are lightweight and don't block the UI
- Auto-dismiss after 3-5 seconds
- Multiple toasts stack vertically
- Maximum 5 toasts visible at once (Streamlit default)

## User Benefits

1. **Transparency**: See exactly what AI is doing
2. **Progress**: Know the search isn't frozen
3. **Metrics**: Real-time quality scores
4. **Debugging**: Identify bottlenecks quickly
5. **Trust**: Builds confidence in AI process
